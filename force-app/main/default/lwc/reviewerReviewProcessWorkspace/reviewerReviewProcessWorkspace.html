<template>
    <div class="reviewer-container">
        <lightning-spinner lwc:if={isLoading} alternative-text="Loading" size="small"></lightning-spinner>
        <template for:each={reviewProcesses} for:item="process">
            <div key={process.Id} class="slds-box reviewer-card">
                <div class="slds-grid">
                    <h1 class="reviewer-title">{process.Name}</h1>
                    <div class="reviewer-tags slds-col_bump-left">
                        <span class="reviewer-tag">{process.endDateLabel}</span>
                    </div>
                </div>

                <div class="reviewer-body">
                    <lightning-tabset>
                        <lightning-tab label="Overview">
                            <div class="reviewer-stats">
                                <div class="reviewer-stat slds-box">
                                    <span class="reviewer-value">{process.totalRecords}</span>
                                    <span class="reviewer-label">Total Records</span>
                                </div>
                                <div class="reviewer-stat slds-box">
                                    <span class="reviewer-value">{process.feedbacks.length}</span>
                                    <span class="reviewer-label">Your Pending</span>
                                </div>
                                <div class="reviewer-stat slds-box">
                                    <span class="reviewer-value">{process.completedFeedback}</span>
                                    <span class="reviewer-label">Your Completed</span>
                                </div>
                            </div>

                            <button type="submit" onclick={handleNewReviewClick} class="new-review-button slds-button slds-button_brand slds-button_stretch">
                                Start New Review
                            </button>
                        </lightning-tab>
                        <lightning-tab lwc:if={process.feedbacks.length} label="Unfinished Reviews">
                            <div class="pending-review-container">
                                <template for:each={process.feedbacks} for:item="feedback">
                                    <div key={feedback.Id} data-id={feedback.Id} class="pending-review-card slds-box slds-grid slds-align_absolute-center">
                                        <div class="pending-review-card-content slds-col slds-grow">
                                            <span class="pending-review-name">{feedback.Name}</span>
                                            <span class="pending-review-tag">{feedback.RecordType__c}</span>
                                        </div>
                                        <div class="slds-col">
                                            <button class="continue-review-button" onclick={handleContinueReview}>Continue</button>
                                        </div>
                                    </div>
                                </template>
                            </div>
                        </lightning-tab>
                    </lightning-tabset>
                </div>
            </div>
        </template>

    </div>
</template>